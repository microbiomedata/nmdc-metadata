id: https://microbiomedata/schema
name: nmdc_schema
description: >-
  Schema for National Microbiome Data Collaborative (NMDC)
license: https://creativecommons.org/publicdomain/zero/1.0/

prefixes:
  nmdc: https://microbiomedata/meta/
  mixs: https://w3id.org/gensc/
  wgs: http://www.w3.org/2003/01/geo/wgs84_pos
  qud: http://qudt.org/1.1/schema/qudt#
  dcterms: http://purl.org/dc/terms/
  biolinkml: https://w3id.org/biolink/biolinkml/
  
default_prefix: nmdc
default_range: string

default_curi_maps:
  - obo_context
  - idot_context

emit_prefixes:
  - rdf
  - rdfs
  - xsd
  - skos

imports:
  - biolinkml:types
  - mixs
  
classes:

  named thing:
    description: "a databased entity or concept/class"
    slots:
      - id
      - name
      - description
      - alternate identifiers

  data object:
    is_a: named thing
    description: >-
      An object that primarily consists of symbols that represent information.  
      Files, records, and omics data are examples of data objects. 
    slots:
      - file_size

  ## TODO: these should be placed in MIxS package
  environmental package:
    abstract: true
    mixin: true
    description: >-
      Parent class for all packages which can be 'mixed into' a biosample class
      
  soil package:
    mixin: true
    slots:
      - depth
    slot_usage:
      depth:
        required: true
    description: >-
      Parent class for all packages which can be 'mixed into' a biosample class
      
  plant-associated package:
    mixin: true
    slots:
      - depth
    slot_usage:
      depth:
        required: false
        
  uber package:
    mixin: true
    mixins:
      - soil package
      - plant-associated package
#...
    description: >-
      all packages mixed into one

  ## ROOT biosample class
      
  biosample:
    abstract: true  ## this should be subclasses
    is_a: named thing
    aliases: ['sample', 'material sample']
    description: >-
      A material sample. It may be environmental (encompassing many organisms) or isolate or tissue.  
      An environmental sample containing genetic material from multiple individuals is commonly referred to as a biosample.  
    slots:
      - lat_lon
      - env_broad_scale
      - env_local_scale
      - env_medium
      - ecosystem
      - ecosystem_category
      - ecosystem_type
      - ecosystem_subtype
      - specific_ecosystem
    slot_usage:
      id:
        description: >-
          The primary identifier for the biosample. Example: GOLD:Gb0205609
      name:
        description: >-
          A human readable name or description of the biosample
      alternate identifiers:
        description: >-
          The same biosample may have distinct identifiers in different databases (e.g. GOLD and EMSL)
      lat_lon:
        required: true
        description: >-
          This is a required field but it's not clear if this should be required for human hosts
      env_broad_scale:
        required: true
      env_local_scale:
        required: true
      env_medium:
        required: true

  # exemplar subclasses; these can incorporate ant number of package mixins;
  # these could be at different levels of granularity, and could even be made
  # on a per-project basis, e.g. bioscales
  soil biosample:
    is_a: biosample
    mixins:
      - soil package
    description: >-
      a biosample that is described purely using the soil package
        
  plant-associated soil biosample:
    is_a: biosample
    mixins:
      - soil package
      - plant-associated package
    description: >-
      a biosample that is described both using the soil package and plant-associated (e.g. rhizosphere)

  ## -- end of exemplars
      
  study:
    is_a: named thing
    aliases: ['proposal', 'research proposal', 'research study']
    description: >-
      A study summarizes the overall goal of a research initiative and outlines the key objective of its underlying projects.  
    slots:
      - annotations
#      - PI name
    slot_usage:
      id:
        description: >-
          The primary identifier for the study.
      name:
        description: >-
          A human readable name or description of the study.
      alternate identifiers:
        description: >-
          The same study may have distinct identifiers in different databases (e.g. GOLD and EMSL)

  biosample processing:
    is_a: named thing
    description: >-
      A process that takes one or more biosamples as inputs and generates one or as outputs.
      Examples of outputs include samples cultivated from another sample or data objects created by instruments runs.
    slots:
      - has input
    slot_usage:
      has input:
        range: biosample

  omics processing:
    is_a: biosample processing
    description: >-
      The methods and processes used to generate omics data from a biosample or organism.
    slots:
      - part of
      - has output
    slot_usage:
      id:
        description: >-
          The primary identifier for the omics processing. E.g. GOLD:GpNNNN
      name:
        description: >-
          A human readable name or description of the omics processing.
      alternate identifiers:
        description: >-
          The same omics processing may have distinct identifiers in different databases (e.g. GOLD and EMSL)
      part of:
        range: study
      has output:
        range: data object

  person:
    is_a: named thing
    description: >-
      represents a person, such as a researcher
    slot_usage:
      id:
        description: >-
          Should be an ORCID. Specify in CURIE format. E.g ORCID:0000-1111-...
    
  attribute value:
    description: >-
      The value for any value of a attribute for a sample. This object can hold both the un-normalized atomic
      value and the structured value
    slots:
      - has raw value
    
  quantity value:
    is_a: attribute value
    description: >-
      A simple quantity, e.g. 2cm
    slots:
      - has unit
      - has numeric value
    slot_usage:
      has raw value:
        description: >-
          Unnormalized atomic string representation, should in syntax {number} {unit}
      has unit:
        description: >-
          The unit of the quantity
      has numeric value:
        description: >-
          The number part of the quantity
        range:
          double

  text value:
    is_a: attribute value
    description: >-
      A basic string value
    slots:
      - language
      
  url value:
    is_a: attribute value
    description: >-
      A value that is a string that conforms to URL syntax

  timestamp value:
    is_a: attribute value
    description: >-
      A value that is a timestamp. The range should be ISO-8601
    #slots:
    #  - year
    #  - month
    #  - day

      
  integer value:
    is_a: attribute value
    description: >-
      A value that is an integer
    slots:
      - has numeric value

  boolean value:
    is_a: attribute value
    description: >-
      A value that is a boolean
    slots:
      - has boolean value
      
  controlled term value:
    is_a: attribute value
    description: >-
      A controlled term or class from an ontology
    # TODO: add fields for ontology, branch

  geolocation value:
    is_a: attribute value
    description: >-
      A normalized value for a location on the earth's surface
    slots:
      - latitude
      - longitude
    slot_usage:
      has raw value:
        description: >-
          The raw value for a  geolocation should follow {lat} {long}
        # to_str: {latitude} {longitude}

  unit:
    id_prefixes:
      - UO
    mappings:
      - qud:Unit
      - UO:0000000

  ontology class:
    is_a: named thing

  environmental material term:
    is_a: ontology class

slots:

  id:
    identifier: false
    multivalued: false
    description: >-
      A unique identifier for a thing.
      Must be either a CURIE shorthand for a URI or a complete URI
    required: false # for now we setting this to false until we develop an id template

  name:
    multivalued: false
    range: string
    description: >-
      A human readable label for an entity

  description:
    range: string
    multivalued: false
    description: >-
      a human-readable description of a thing
    slot_uri: dcterms:description

  # this will be obsoleted
  annotations:
    multivalued: true
    
  attribute:
    aliases: ['field', 'property', 'template field', 'key', 'characteristic']
    abstract: true
    domain: named thing
    description: >-
      A attribute of a biosample. Examples: depth, habitat, material.
      For NMDC, attributes SHOULD be mapped to terms within a MIxS template
    
  has raw value:
    description: >-
      The value that was specified for an annotation in raw form, i.e. a string. E.g. "2 cm" or "2-4 cm"
    multivalued: false
    required: false
    domain: attribute value
    range: string
    
  has unit:
    description: >-
      Links a quantity value to a unit
    range: unit
    multivalued: true     ## workaround for https://github.com/biolink/biolinkml/issues/86
    mappings:
      - qud:unit

  has numeric value:
    description: >-
      Links a quantity value to a number
    multivalued: false
    mappings:
      - qud:quantityValue
      
  has boolean value:
    description: >-
      Links a quantity value to a boolean
    range: boolean
    multivalued: false
      
  alternate identifiers:
    aliases: ['mappings', 'alt ids', 'xrefs']
    description: >-
      Non-primary identifiers
    multivalued: true
    range: string
    required: false
    
  latitude:
    domain: geolocation value
    range: float
    description: >-
      latitude
    slot_uri: wgs:lat

  longitude:
    domain: geolocation value
    range: float
    description: >-
      longitude
    slot_uri: wgs:long

  has input:
    aliases: ['input']
    domain: named thing
    # range: named thing
    multivalued: true
    description: >-
      An input to a process.
    
  has output:
    aliases: ['output']
    #domain: named thing
    #range: named thing
    multivalued: true
    description: >-
      An output biosample to a processing step

  
  part of:
    aliases: ['is part of']
    domain: named thing
    multivalued: true
    slot_uri: http://purl.org/dc/terms/isPartOf
    description: >-
      Links a resource to another resource that either logically or physically includes it.

  language:
    range: string
    description: >-
      Should use standard codes, e.g. "en"

  ## DATA

  file_size:
    is_a: attribute
    description: >-
      units should be bytes.. may be overkill to allow different units
    
  ## GOLD PATHS

  gold_path_field:
    is_a: attribute
    abstract: true
    
  ecosystem:
    is_a: gold_path_field
  ecosystem_category:
    is_a: gold_path_field
  ecosystem_type:
    is_a: gold_path_field
  ecosystem_subtype:
    is_a: gold_path_field
  specific_ecosystem:
    is_a: gold_path_field
