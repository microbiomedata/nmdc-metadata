id: https://microbiomedata/schema
name: nmdc_schema
description: >-
  Schema for National Microbiome Data Collaborative (NMDC)
license: https://creativecommons.org/publicdomain/zero/1.0/

prefixes:
  nmdc: https://microbiomedata/meta/
  mixs: https://w3id.org/gensc/
  wgs: http://www.w3.org/2003/01/geo/wgs84_pos
  qud: http://qudt.org/1.1/schema/qudt#
  dcterms: http://purl.org/dc/terms/
  biolinkml: https://w3id.org/biolink/biolinkml/
  
default_prefix: nmdc
default_range: string

default_curi_maps:
  - obo_context
  - idot_context

emit_prefixes:
  - rdf
  - rdfs
  - xsd
  - skos

imports:
  - biolinkml:types
  - mixs
  
classes:

  named thing:
    description: "a databased entity or concept/class"
    slots:
      - id
      - name
      - description
      - alternate identifiers

  data object:
    is_a: named thing
    description: >-
      An object that primarily consists of symbols that represent information.  
      Files, records, and omics data are examples of data objects. 
    slots:
      - annotations
      
  biosample:
    is_a: named thing
    aliases: ['sample', 'material sample']
    description: >-
      A material sample. It may be environmental (encompassing many organisms) or isolate or tissue.  
      An environmental sample containing genetic material from multiple individuals is commonly referred to as a biosample.  
    slots:
      - lat_lon
      - depth
      - env_broad_scale
      - env_local_scale
      - env_medium
    slot_usage:
      id:
        description: >-
          The primary identifier for the biosample. Example: GOLD:Gb0205609
      name:
        description: >-
          A human readable name or description of the biosample
      alternate identifiers:
        description: >-
          The same biosample may have distinct identifiers in different databases (e.g. GOLD and EMSL)
 
  study:
    is_a: named thing
    aliases: ['proposal', 'research proposal', 'research study']
    description: >-
      A study summarizes the overall goal of a research initiative and outlines the key objective of its underlying projects.  
    slots:
      - annotations
#      - PI name
    slot_usage:
      id:
        description: >-
          The primary identifier for the study.
      name:
        description: >-
          A human readable name or description of the study.
      alternate identifiers:
        description: >-
          The same study may have distinct identifiers in different databases (e.g. GOLD and EMSL)

  biosample processing:
    is_a: named thing
    description: >-
      A process that takes one or more biosamples as inputs and generates one or as outputs.
      Examples of outputs include samples cultivated from another sample or data objects created by instruments runs.
    slots:
      - has input
    slot_usage:
      has input:
        range: biosample

  omics processing:
    is_a: biosample processing
    description: >-
      The methods and processes used to generate omics data from a biosample or organism.
    slots:
      - part of
      - has output
    slot_usage:
      id:
        description: >-
          The primary identifier for the omics processing.
      name:
        description: >-
          A human readable name or description of the omics processing.
      alternate identifiers:
        description: >-
          The same omics processing may have distinct identifiers in different databases (e.g. GOLD and EMSL)
      part of:
        range: study
      has output:
        range: data object
    
  attribute value:
    description: >-
      The value for any value of a attribute for a sample. This object can hold both the un-normalized atomic
      value and the structured value
    slots:
      - has raw value
    
  quantity value:
    is_a: attribute value
    description: >-
      A simple quantity, e.g. 2cm
    slots:
      - has unit
      - has numeric value

  text value:
    is_a: attribute value
    description: >-
      A basic string value
    slots:
      - language
      
  url value:
    is_a: attribute value
    description: >-
      A value that is a string that conforms to URL syntax
      
  integer value:
    is_a: attribute value
    description: >-
      A value that is an integer
    slots:
      - has numeric value

  boolean value:
    is_a: attribute value
    description: >-
      A value that is a boolean
    slots:
      - has numeric value
      
  controlled term value:
    is_a: attribute value
    description: >-
      A controlled term or class from an ontology
    # TODO: add fields for ontology, branch

  geolocation value:
    is_a: attribute value
    description: >-
      A normalized value for a location on the earth's surface
    slots:
      - latitude
      - longitude
    slot_usage:
      has raw value:
        description: >-
          The raw value for a  geolocation should follow {lat} {long}
        # to_str: {latitude} {longitude}

  unit:
    id_prefixes:
      - UO
    mappings:
      - qud:Unit
      - UO:0000000

  ontology class:
    is_a: named thing

  environmental material term:
    is_a: ontology class

slots:

  id:
    identifier: false
    multivalued: false
    description: >-
      A unique identifier for a thing.
      Must be either a CURIE shorthand for a URI or a complete URI
    required: false # for now we setting this to false until we develop an id template

  name:
    multivalued: false
    range: string
    description: >-
      A human readable label for an entity

  description:
    range: string
    multivalued: false
    description: >-
      a human-readable description of a thing
    slot_uri: dcterms:description

  # this will be obsoleted
  annotations:
    multivalued: true
    
  attribute:
    aliases: ['field', 'property', 'template field', 'key', 'characteristic']
    abstract: true
    domain: named thing
    description: >-
      A attribute of a biosample. Examples: depth, habitat, material.
      For NMDC, attributes SHOULD be mapped to terms within a MIxS template
    
  has raw value:
    description: >-
      The value that was specified for an annotation in raw form, i.e. a string. E.g. "2 cm" or "2-4 cm"
    multivalued: false
    required: false
    domain: attribute value
    range: string
    
  has unit:
    description: >-
      Links a quantity value to a unit
    range: unit
    multivalued: true     ## workaround for https://github.com/biolink/biolinkml/issues/86
    mappings:
      - qud:unit

  has numeric value:
    description: >-
      Links a quantity value to a number
    range: double
    multivalued: false
    mappings:
      - qud:quantityValue
      
  alternate identifiers:
    aliases: ['mappings', 'alt ids', 'xrefs']
    description: >-
      Non-primary identifiers
    multivalued: true
    range: string
    required: false
    
  latitude:
    domain: geolocation value
    range: float
    description: >-
      latitude
    slot_uri: wgs:lat

  longitude:
    domain: geolocation value
    range: float
    description: >-
      longitude
    slot_uri: wgs:long

  has input:
    aliases: ['input']
    domain: named thing
    # range: named thing
    multivalued: true
    description: >-
      An input to a process.
    
  has output:
    aliases: ['output']
    #domain: named thing
    #range: named thing
    multivalued: true
    description: >-
      An output biosample to a processing step

  
  part of:
    aliases: ['is part of']
    domain: named thing
    multivalued: true
    slot_uri: http://purl.org/dc/terms/isPartOf
    description: >-
      Links a resource to another resource that either logically or physically includes it.

  language:
    range: string
    description: >-
      Should use standard codes, e.g. "en"

  ## MIxS
    
  geolocation:
    is_a: attribute
    range: geolocation value
    # string_range: {latitude} {longitude}
    # Example: {id: sample123, geolocation: {type: geolocation_value, has_raw_value: "123 456", latitude: 123, longitude: 456}}
    
    
  xxxdepth:
    multivalued: false
    is_a: attribute
    range: quantity value
    mappings:
      - PATO:nnn
      - MIXS:nnn
      - GOLDmeta:depth
    
  water calcium:
    is_a: attribute
    range: quantity value
    mappings:
      - PATO:nnn
      - MIXS:nnn
      - ENVO:nnn

  material:
    is_a: attribute
    range: environmental material term

  biome:
    aliases: ['broad scale environment']
    is_a: attribute
    range: controlled term value

  feature:
    is_a: attribute
    range: controlled term value
  
